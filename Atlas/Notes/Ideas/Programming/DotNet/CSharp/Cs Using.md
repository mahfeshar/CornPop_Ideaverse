---
up:
  - "[[CSharp MOC]]"
related: 
created: 2024-10-15
---

الـ **using statement** في C# هي واحدة من الأدوات المهمة جدًا اللي بتساعدك في إدارة الموارد بشكل سليم داخل برنامجك. 
الهدف الأساسي منها هو التأكد من إن الموارد اللي بتستخدمها زي الملفات أو الاتصالات بالشبكة أو الأدوات اللي بتستهلك الذاكرة (مثل الكائنات التي تستهلك الموارد) بيتم "تحريرها" أو التخلص منها بشكل صحيح بعد الانتهاء من استخدامها.

### مفهوم الـ using statement
في البرمجة، لما بتنشئ كائن أو مورد معين (زي فتح اتصال بقاعدة بيانات أو إنشاء كائن يستهلك الذاكرة)، الكائن ده بيستهلك موارد من النظام (زي الذاكرة أو المعالج). 
لو مفيش طريقة للتخلص من الكائن بعد ما تخلص من استخدامه، الموارد دي هتفضل محجوزة، وده ممكن يسبب مشاكل زي تسريب الذاكرة (memory leaks).

الـ **using statement** في C# بتسهل عليك المهمة دي لأنها بتضمن إن الكائن اللي استخدمته بيتم التخلص منه تلقائيًا لما تخلص من استخدامه. 
لو الكائن بيدعم واجهة الـ **`IDisposable`**، الـ **using statement** هتتأكد إنه بعد ما تنتهي منه، الكائن ده بيتم استدعاء الدالة **Dispose** الخاصة به، اللي وظيفتها تحرير الموارد اللي الكائن كان بيستخدمها.

### مثال بسيط على using statement

مثال بسيط هو التعامل مع الملفات. 
لو عايز تقرأ ملف، لازم تفتح الملف الأول، وبعد كده تقراه، وبعدين تقفل الملف. 
بدون الـ **using statement**، هتحتاج تقفل الملف بنفسك بعد ما تخلص من استخدامه. 
لكن لو نسيت تقفله، الملف هيفضل مفتوح، وده ممكن يسبب مشاكل.

#### بدون using statement:
```csharp
FileStream file = new FileStream("path/to/file", FileMode.Open);
try
{
    // قراءة البيانات من الملف
}
finally
{
    file.Dispose();  // التأكد من إغلاق الملف
}
```

#### مع using statement:
```csharp
using (FileStream file = new FileStream("path/to/file", FileMode.Open))
{
    // قراءة البيانات من الملف
}
// هنا الـ using هتتأكد من إغلاق الملف تلقائيًا بعد ما تخلص من الكود
```

في المثال اللي مع **using statement**، بمجرد انتهاء الكود داخل الكتلة (block)، دالة **Dispose** هتتستدعى تلقائيًا حتى لو حصل استثناء أثناء التنفيذ. ده بيضمن إنه حتى في حالة وجود خطأ، الموارد اللي بتستخدمها هتتحرر.

### ليه بنستخدم using؟
- **تحسين إدارة الموارد**: بتسهل عليك التخلص من الموارد اللي مش محتاجها بعد كده.
- **تجنب تسريب الذاكرة**: لما تستخدم الـ **using statement**، بتضمن إن الموارد اللي استخدمتها مش هتفضل محتلة الذاكرة بعد ما تخلص.
- **الأمان**: بتقلل من الأخطاء اللي ممكن تحصل لو نسيت تستدعي دالة **Dispose** بنفسك.

### إزاي بتشتغل الـ using statement؟
الـ **using statement** بتشتغل مع أي كائن بيطبق واجهة الـ **IDisposable**. 
الـ **IDisposable** هي واجهة ([[Cs Interface]]) في C# بتحتوي على دالة واحدة اسمها **Dispose**. 
الكائنات اللي بتستهلك موارد النظام زي ملفات أو اتصالات شبكية، لازم تطبق الواجهة دي عشان نقدر نستخدم الـ **using statement** معاها.

#### الكود مع الـ using statement:
```csharp
using var hmac = new HMACSHA512();
```

في المثال ده، استخدمنا **HMACSHA512** عشان نعمل **hashing** لكلمة المرور. 
بمجرد الانتهاء من استخدام الـ **HMACSHA512**، الـ **Dispose** الخاصة بالكائن هتستدعى تلقائيًا، وده هيحرر الموارد اللي الكائن كان بيستخدمها.

### خلاصة:
الـ **using statement** هي أداة قوية جدًا في C#، لأنها بتضمن إدارة سليمة للموارد وتقليل الأخطاء اللي ممكن تحصل من نسيان تحرير الموارد.